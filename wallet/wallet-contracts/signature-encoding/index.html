<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-wallet/wallet-contracts/signature-encoding">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.0">
<title data-rh="true">Signature Encoding | Sequence</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://docs.sequence.xyz/img/sequence-banner.png"><meta data-rh="true" name="twitter:image" content="https://docs.sequence.xyz/img/sequence-banner.png"><meta data-rh="true" property="og:url" content="https://docs.sequence.xyz/wallet/wallet-contracts/signature-encoding"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Signature Encoding | Sequence"><meta data-rh="true" name="description" content="Sequence Wallets support ERC-1271 Standard Contract Signature Verification to allow signing of transactions and messages."><meta data-rh="true" property="og:description" content="Sequence Wallets support ERC-1271 Standard Contract Signature Verification to allow signing of transactions and messages."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.sequence.xyz/wallet/wallet-contracts/signature-encoding"><link data-rh="true" rel="alternate" href="https://docs.sequence.xyz/wallet/wallet-contracts/signature-encoding" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.sequence.xyz/wallet/wallet-contracts/signature-encoding" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.2e607eef.css">
<link rel="preload" href="/assets/js/runtime~main.286168b1.js" as="script">
<link rel="preload" href="/assets/js/main.23aefb16.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_s0pr" role="banner"><div class="announcementBarPlaceholder_qxfj"></div><div class="content_knG7 announcementBarContent_dpRF">❤️ To follow Sequence product updates, follow us on <a target="_blank" rel="noopener noreferrer" href="https://twitter.com/0xsequence">Twitter</a></div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_iXyO"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="flex items-center justify-between w-full"><div class="flex items-end"><a class="flex items-end" href="/"><img src="/img/icons/sequence-composite-dark.svg" class="mr-3 dark:block hidden"><img src="/img/icons/sequence-composite-light.svg" class="mr-3 dark:hidden block"></a></div><div class="flex items-center gap-x-4"><a class="hover:opacity-50 items-center mobile-nav:flex hidden" href="https://discord.gg/sequence" target="_blank" rel="noopener noreferrer"><img class="dark:block hidden" alt="discord logo" src="/img/icons/discord-icon-dark.svg"><img class="dark:hidden block" alt="discord logo" src="/img/icons/discord-icon-light.svg"></a><a class="hover:opacity-50 items-center mobile-nav:flex hidden" href="https://twitter.com/0xsequence" target="_blank" rel="noopener noreferrer"><img class="dark:block hidden" alt="twitter logo" src="/img/icons/twitter-icon-dark.svg"><img class="dark:hidden block" alt="twitter logo" src="/img/icons/twitter-icon-light.svg"></a><a class="hover:opacity-50 items-center mobile-nav:flex hidden" href="https://github.com/0xsequence" target="_blank" rel="noopener noreferrer"><img class="dark:block hidden" alt="github logo" src="/img/icons/github-icon-dark.svg"><img class="dark:hidden block" alt="github logo" src="/img/icons/github-icon-light.svg"></a><a class="hover:opacity-50 items-center mobile-nav:flex hidden" href="mailto:hello@horizon.io" target="_blank" rel="noopener noreferrer"><img class="dark:block hidden" alt="email logo" src="/img/icons/email-icon-dark.svg"><img class="dark:hidden block" alt="email logo" src="/img/icons/email-icon-light.svg"></a><a class="hover:opacity-50 items-center mobile-nav:flex hidden" href="/support"><img class="dark:block hidden" alt="faq logo" src="/img/icons/faq-icon-dark.svg"><img class="dark:hidden block" alt="faq logo" src="/img/icons/faq-icon-light.svg"></a><button disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite" class="border-0 bg-transparent cursor-pointer p-0 hover:opacity-50 flex items-center mobile-nav:block hidden"><img src="/img/icons/light-mode-icon.svg" class="dark:hidden block"><img src="/img/icons/dark-mode-icon.svg" class="dark:block hidden"></button><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div><button class="shrink-0 border-0 bg-transparent p-0 pr-1 cursor-pointer mobile-nav:hidden block"><svg class="dark:fill-[#d9d9d9] fill-[#cac8b6]" width="16" height="9" viewBox="0 0 16 9" fill="none" xmlns="http://www.w3.org/2000/svg"><rect y="0.865723" width="16" height="1"></rect><rect y="7.86572" width="16" height="1"></rect></svg></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_eExm docsWrapper_W2AM"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage_qMb8"><aside class="theme-doc-sidebar-container docSidebarContainer_rpaz"><div class="sidebar_mhZE"><nav class="overflow-x-hidden text-sm font-normal thin-scrollbar p-2 menu_Y1UP menuWithAnnouncementBar_fPny"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/">Introduction</a><button aria-label="Toggle the collapsible sidebar category &#x27;Introduction&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/getting-started">Getting Started</a><button aria-label="Toggle the collapsible sidebar category &#x27;Getting Started&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/wallet">Wallet</a><button aria-label="Toggle the collapsible sidebar category &#x27;Wallet&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/wallet/installation">Installation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/wallet/platforms">Platforms</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/wallet/guides/connect-wallet">Developer Guides</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/wallet/connectors/overview">Wallet Connectors</a><button aria-label="Toggle the collapsible sidebar category &#x27;Wallet Connectors&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/key-management">Key Management</a><button aria-label="Toggle the collapsible sidebar category &#x27;Key Management&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/fiat-on-ramps">Fiat Support</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/wallet/wallet-contracts/why">Wallet Contracts</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/wallet/wallet-contracts/why">Why smart contracts wallets?</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/wallet/wallet-contracts/universal-deployer">Universal Deployer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/wallet/wallet-contracts/wallet-factory">Wallet Factory</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/wallet/wallet-contracts/wallet-configuration">Wallet Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/wallet/wallet-contracts/modules-and-updates">Modules &amp; wallet update</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/wallet/wallet-contracts/main-module-upgradeable">MainModuleUpgradeable &amp; configuration migration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/wallet/wallet-contracts/transaction-encoding">Transaction encoding</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/wallet/wallet-contracts/signature-encoding">Signature Encoding</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/wallet/wallet-contracts/nested-transaction-batching">Nested Transaction Batching</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/wallet/wallet-contracts/guest-module">GuestModule and on-demand deployment</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/wallet/wallet-contracts/wallet-context">Wallet Context</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/wallet/wallet-contracts/contract-audits">Contract Audits</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/indexer">Indexer</a><button aria-label="Toggle the collapsible sidebar category &#x27;Indexer&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/metadata">Metadata</a><button aria-label="Toggle the collapsible sidebar category &#x27;Metadata&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/relayer">Relayer</a><button aria-label="Toggle the collapsible sidebar category &#x27;Relayer&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/games-sdk">Games SDK</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/unity-sdk">Unity SDK</a><button aria-label="Toggle the collapsible sidebar category &#x27;Unity SDK&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/node-gateway">Node-Gateway</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/marketplace">Marketplace</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/support">Community &amp; Support</a><button aria-label="Toggle the collapsible sidebar category &#x27;Community &amp; Support&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col"><div class="w-full max-w-[850px] mx-auto"><article><nav aria-label="Breadcrumbs"><ul class="list-none flex flex-wrap p-0" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="after:content-[&#x27;&gt;&#x27;] after:w-10 after:h-10 after:text-black-50 dark:after:text-white-50 after:mx-2"><a aria-label="Home page" class="hover:no-underline" href="/"><span class="font-inter font-normal dark:text-white-50 text-black-50 dark:hover:text-white-80 hover:text-black-80">⌂</span></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="after:content-[&#x27;&gt;&#x27;] after:w-10 after:h-10 after:text-black-50 dark:after:text-white-50 after:mx-2"><a class="font-inter font-normal text-sm dark:text-white-50 text-black-50 dark:hover:text-white-80 hover:text-black-80 hover:no-underline transition-none" itemprop="item" href="/wallet"><span itemprop="name">Wallet</span></a><meta itemprop="position" content="1"></li><li class="after:content-[&#x27;&gt;&#x27;] after:w-10 after:h-10 after:text-black-50 dark:after:text-white-50 after:mx-2"><span class="font-inter font-normal text-sm dark:text-white-50 text-black-50">Wallet Contracts</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem"><span class="font-inter font-normal text-sm dark:text-white-80 text-black-80" itemprop="name">Signature Encoding</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Signature Encoding</h1><p>Sequence Wallets support <a href="https://eips.ethereum.org/EIPS/eip-1271" target="_blank" rel="noopener noreferrer">ERC-1271 Standard Contract Signature Verification</a> to allow signing of transactions and messages.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="erc-191-ethereum-signed-data">ERC-191 Ethereum Signed Data<a href="#erc-191-ethereum-signed-data" class="hash-link" aria-label="Direct link to ERC-191 Ethereum Signed Data" title="Direct link to ERC-191 Ethereum Signed Data">​</a></h2><p>Messages encoded with as <a href="https://eips.ethereum.org/EIPS/eip-191" target="_blank" rel="noopener noreferrer">ERC-191 Ethereum Signed Data</a> are able to be created and signed as follows.</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#1d1d1d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword module" style="font-style:italic">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">Wallet</span><span class="token imports"> </span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword module" style="font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;@0xsequence/wallet&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Construct your Sequence Wallet (out of scope for this section)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> wallet</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token maybe-class-name">Wallet</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> message </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Hello, World!&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> prefixedMessage </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;\x19Ethereum Signed Message:\n&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">len</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">message</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> message</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> signature </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="font-style:italic">await</span><span class="token plain"> wallet</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">signMessage</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">prefixedMessage</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The above will iterate through local, signing the message. If the threshold is reached, the signature is returned.
Otherwise the library will iterate through the remote signers as well.
The resulting signatures are joined and encoded as a hex string.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="erc-712-structured-data-signatures">ERC-712 Structured Data Signatures<a href="#erc-712-structured-data-signatures" class="hash-link" aria-label="Direct link to ERC-712 Structured Data Signatures" title="Direct link to ERC-712 Structured Data Signatures">​</a></h2><p><a href="https://eips.ethereum.org/EIPS/eip-712" target="_blank" rel="noopener noreferrer">ERC-712 Structured Data</a> can also be signed in a similar fashion.</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#1d1d1d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword module" style="font-style:italic">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">Wallet</span><span class="token imports"> </span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword module" style="font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;@0xsequence/wallet&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword module" style="font-style:italic">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token imports"> encodeTypedDataDigest </span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword module" style="font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;@0xsequence/utils&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Construct your Sequence Wallet (out of scope for this section)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> wallet</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token maybe-class-name">Wallet</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Encode the typed data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> chainId </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> typedData </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    types</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token maybe-class-name">Person</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> name</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;name&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> type</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;string&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> name</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;wallet&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> type</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;address&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> name</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;count&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> type</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;uint8&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    primaryType</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;Person&#x27;</span><span class="token plain"> </span><span class="token keyword module" style="font-style:italic">as</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">const</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    domain</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        name</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;Ether Mail&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        version</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;1&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        chainId</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> chainId</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        verifyingContract</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;0xCcCCccccCCCCcCCCCCCcCcCccCcCCCcCcccccccC&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    message</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        name</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;Bob&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        wallet</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;0xbBbBBBBbbBBBbbbBbbBbbbbBBbBbbbbBbBbbBBbB&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        count</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> hashedData </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">encodeTypedDataDigest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">typedData</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> signature </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="font-style:italic">await</span><span class="token plain"> wallet</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">signMessage</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">hashedData</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The above will iterate through local, signing the message. If the threshold is reached, the signature is returned.
Otherwise the library will iterate through the remote signers as well.
The resulting signatures are joined and encoded as a hex string.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="verification">Verification<a href="#verification" class="hash-link" aria-label="Direct link to Verification" title="Direct link to Verification">​</a></h2><p>The signature can be verified by calling the <code>isValidSignature</code> method on the wallet.</p><div class="language-sol codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#1d1d1d"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sol codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">  /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   * @notice Verifies whether the provided signature is valid with respect to the provided hash</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   * @dev MUST return the correct magic value if the signature provided is valid for the provided hash</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   *   &gt; The bytes4 magic value to return when signature is valid is 0x1626ba7e : bytes4(keccak256(&quot;isValidSignature(bytes32,bytes)&quot;))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   * @param _hash       keccak256 hash that was signed</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   * @param _signatures Signature byte array associated with _data.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   *                    Encoded as abi.encode(Signature[], Configs)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   * @return magicValue Magic value 0x1626ba7e if the signature is valid and 0x0 otherwise</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  function isValidSignature(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    bytes32 _hash,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    bytes calldata _signatures</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  ) public override virtual view returns (bytes4) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // Validate signatures</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (bool isValid,) = _signatureValidation(_hash, _signatures);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if (isValid) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      return SELECTOR_ERC1271_BYTES32_BYTES;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return bytes4(0);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This will iterate through the combined signatures and validate that the resulting signature breaches the wallet&#x27;s threshold.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/0xsequence/docs/edit/master/docs/03-wallet/10-wallet-contracts/08-signature-encoding.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="grid grid-cols-2 justify-items-stretch gap-x-2" aria-label="Docs pages navigation"><a class="hover:no-underline group rounded-lg border border-solid p-4 dark:border-[rgba(255,255,255,0.5)] border-[rgba(0,0,0,0.5)]" href="/wallet/wallet-contracts/transaction-encoding"><div class="flex flex-col group-hover:opacity-50 items-start"><div class="dark:text-white-50 text-black-50 text-sm font-normal">Previous</div><div class="dark:text-white-80 text-black-80 text-sm font-bold mb-1">Transaction encoding</div></div></a><a class="hover:no-underline group rounded-lg border border-solid p-4 dark:border-[rgba(255,255,255,0.5)] border-[rgba(0,0,0,0.5)]" href="/wallet/wallet-contracts/nested-transaction-batching"><div class="flex flex-col group-hover:opacity-50 items-end"><div class="dark:text-white-50 text-black-50 text-sm font-normal">Next</div><div class="dark:text-white-80 text-black-80 text-sm font-bold mb-1">Nested Transaction Batching</div></div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#erc-191-ethereum-signed-data" class="table-of-contents__link toc-highlight">ERC-191 Ethereum Signed Data</a></li><li><a href="#erc-712-structured-data-signatures" class="table-of-contents__link toc-highlight">ERC-712 Structured Data Signatures</a></li><li><a href="#verification" class="table-of-contents__link toc-highlight">Verification</a></li></ul></div></div></div></div></main></div></div></div>
<script src="/assets/js/runtime~main.286168b1.js"></script>
<script src="/assets/js/main.23aefb16.js"></script>
</body>
</html>
# Validation

Users with Auth + WaaS go through two distinct flows based on the login method:

### Social login

Users who log in via established social auth providers like Google or Facebook don't need additional validation. Both Amazon Nitro and the Sequence Guard already validate the provider's `idToken`.

### Email login (magic link)

For users logging in with an email, Amazon Cognito sends a magic link to validate their identity. However, this only covers Amazon's side of things. Sequence Guard performs its own validation. It's advisable to delay this second validation until a wallet-related action is required, to avoid double-validation prompts.

## Validation status

To check the validation status of the current session, use the `isSessionValid` method. This returns `true` for social logins and `false` for email logins until email validation is complete.

```ts
const isValid = await waas.isSessionValid();
console.log(isValid);
```
```stdout
true
```

### Trigger session validation

Manually trigger a session validation with the `validateSession` method. This will send a validation link to the user's email. If validated within 10 minutes, the method returns `true`; otherwise, it returns `false`.

```ts
const result = await waas.validateSession();
```
```stdout
true
```

#### Redirect URL

By default, the validation link **does not** redirect the user after validation. Instead, it displays a success message and prompts the user to close the window. To redirect the user after validation, pass a `redirectUrl` to the `validateSession` method.

```ts
await waas.validateSession({
  redirectUrl: 'https://myapp.com/checkout'
});
```

The redirect URL can also be passed to any method that might trigger session validation, such as `sendTransaction`.

```ts
const tx = await waas.sendERC20({
  validation: {
    redirectUrl: 'https://myapp.com/checkout'
  },
  chainId: 42161,
  token: '0x6b175474e89094c44da98b954eedeac495271d0f', // DAI
  to: '0x27CabC9700EE6Db2797b6AC1e1eCe81C72A2cD8D',    // Recipient
  value: '200000000000000000000',                      // 200 DAI
})
```

### Listen for session validations

Events like transaction sends may silently prompt session validation. Use the `onValidationRequired` hook to catch such instances.

```ts
waas.onValidationRequired(() => {
  console.log('Session has been triggered for validation');
});

await waas.sendTransaction({ chainId: 1 }, { to: '0x...', value: '1' });
```
```stdout
Session has been triggered for validation
```

## Automatic session validation

Session validation is automatic when certain actions requiring validation are performed. This can be managed using the `onValidationRequired` hook.

```ts
const tx = await waas.sendTransaction({
  chainId: 1,
  validation: {
    onValidationRequired: () => {
      console.log('Session has been triggered for validation');
      return true;
    }
  },
  to: '0x061150e5574716DBb1a2cdf54b3DcE9F94395f65',
  value: '1'
});
```

By returning `true` or `false` from the `onValidationRequired` hook, you either continue or cancel the action, respectively.

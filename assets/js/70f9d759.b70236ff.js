"use strict";(self.webpackChunk_0xsequence_docs=self.webpackChunk_0xsequence_docs||[]).push([[7776],{8979:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>i,contentTitle:()=>a,default:()=>u,frontMatter:()=>c,metadata:()=>s,toc:()=>l});var o=n(1527),r=n(7279);const c={},a="Trust Contract Recovery Flow",s={id:"waas/implementation/trust-recovery",title:"Trust Contract Recovery Flow",description:"Sequence WaaS accounts are protected by a disaster recovery mechanism contract called Trust. This document outlines the working mechanism behind the Trust contract, as well as the recovery flow to be triggered during a disaster scenario.",source:"@site/docs/110-waas/03-implementation/03-trust-recovery.mdx",sourceDirName:"110-waas/03-implementation",slug:"/waas/implementation/trust-recovery",permalink:"/waas/implementation/trust-recovery",draft:!1,unlisted:!1,editUrl:"https://github.com/0xsequence/docs/edit/master/docs/110-waas/03-implementation/03-trust-recovery.mdx",tags:[],version:"current",sidebarPosition:3,frontMatter:{},sidebar:"sidebar",previous:{title:"Response Payloads",permalink:"/waas/implementation/responses"},next:{title:"Introduction",permalink:"/unity-waas-sdk"}},i={},l=[{value:"Trust Contract Architecture",id:"trust-contract-architecture",level:2},{value:"Unlock State Monitoring",id:"unlock-state-monitoring",level:2},{value:"Disaster Recovery Flow",id:"disaster-recovery-flow",level:2}];function d(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",p:"p",...(0,r.a)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.h1,{id:"trust-contract-recovery-flow",children:"Trust Contract Recovery Flow"}),"\n",(0,o.jsx)(t.p,{children:"Sequence WaaS accounts are protected by a disaster recovery mechanism contract called Trust. This document outlines the working mechanism behind the Trust contract, as well as the recovery flow to be triggered during a disaster scenario."}),"\n",(0,o.jsx)(t.h2,{id:"trust-contract-architecture",children:"Trust Contract Architecture"}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.a,{href:"https://github.com/0xsequence/wallet-contracts/blob/master/contracts/trust/Trust.sol",children:"Trust"})," is essentially a time lock contract. For every configured WaaS tenant project, there are two Trust contract instances deployed. One instance is controlled by the recovery wallet of the project. The other instance is controlled by the Sequence recovery wallet. In their default state, Trust contracts are in locked status. While locked, neither party can access WaaS accounts created under the tenant configuration."]}),"\n",(0,o.jsxs)(t.p,{children:["The only way for a Trust contract to be unlocked is for one of the controlling parties to call the ",(0,o.jsx)(t.code,{children:"setUnlocksAt"})," method on the Trust contract instance controlled by the other party. When this method is called, Trust contract instance goes into countdown state, beginning an enforced 90-day countdown. Since the countdown state is on-chain, it's publicly available for either party to observe."]}),"\n",(0,o.jsxs)(t.p,{children:["Once the countdown is over, the party that called ",(0,o.jsx)(t.code,{children:"setUnlocksAt"})," gains control over the Trust instance of the counterparty. Having control over both instances, they can recover all accounts created with the WaaS tenant configuration."]}),"\n",(0,o.jsx)(t.h2,{id:"unlock-state-monitoring",children:"Unlock State Monitoring"}),"\n",(0,o.jsxs)(t.p,{children:["Sequence provides unlock state monitoring for all deployed Trust contract instances. This service runs under the existing Sequence WaaS implementation deployed on AWS Nitro Secure Enclave instances. Monitoring system checks every Trust contract instance and notifies both Sequence team and the project owner when an unlock state is detected on a deployed contract. This ensures that neither party can call ",(0,o.jsx)(t.code,{children:"setUnlocksAt"})," on another party's contract without notifying them."]}),"\n",(0,o.jsx)(t.h2,{id:"disaster-recovery-flow",children:"Disaster Recovery Flow"}),"\n",(0,o.jsxs)(t.p,{children:["Trust contracts are deployed to recover accounts in the unlikely case that one of the parties disappears and accounts created with the WaaS configuration are inaccessible. In such a case, the counterparty can initiate the recovery flow by calling the ",(0,o.jsx)(t.code,{children:"setUnlocksAt"})," method on the other party's Trust contract instance. This will automatically trigger unlock notifications for both parties until the countdown period is over. Once the 90-day countdown period concludes, accounts created as well as the tokens held in the accounts can be recovered."]})]})}function u(e={}){const{wrapper:t}={...(0,r.a)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},7279:(e,t,n)=>{n.d(t,{Z:()=>s,a:()=>a});var o=n(959);const r={},c=o.createContext(r);function a(e){const t=o.useContext(c);return o.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),o.createElement(c.Provider,{value:t},e.children)}}}]);
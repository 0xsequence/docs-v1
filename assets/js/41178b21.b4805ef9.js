"use strict";(self.webpackChunk_0xsequence_docs=self.webpackChunk_0xsequence_docs||[]).push([[9265],{2769:(e,t,l)=>{l.r(t),l.d(t,{assets:()=>i,contentTitle:()=>r,default:()=>h,frontMatter:()=>s,metadata:()=>c,toc:()=>o});var a=l(1527),n=l(4089);const s={},r="Wallet Factory",c={id:"wallet/wallet-contracts/wallet-factory",title:"Wallet Factory",description:'Sequence Wallets are created using the Factory contract, when called it creates child MinimalUpgradeableProxies contracts, which are in essence the "boot" code of all Sequence wallets.',source:"@site/docs/03-wallet/10-wallet-contracts/03-wallet-factory.mdx",sourceDirName:"03-wallet/10-wallet-contracts",slug:"/wallet/wallet-contracts/wallet-factory",permalink:"/wallet/wallet-contracts/wallet-factory",draft:!1,unlisted:!1,editUrl:"https://github.com/0xsequence/docs/edit/master/docs/03-wallet/10-wallet-contracts/03-wallet-factory.mdx",tags:[],version:"current",sidebarPosition:3,frontMatter:{},sidebar:"sidebar",previous:{title:"Universal Deployer",permalink:"/wallet/wallet-contracts/universal-deployer"},next:{title:"Wallet Configuration",permalink:"/wallet/wallet-contracts/wallet-configuration"}},i={},o=[{value:"Factory API",id:"factory-api",level:2},{value:"deploy",id:"deploy",level:3},{value:"Parameters:",id:"parameters",level:4},{value:"Return Values:",id:"return-values",level:4},{value:"Counter factual addresses",id:"counter-factual-addresses",level:2}];function d(e){const t={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,n.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.h1,{id:"wallet-factory",children:"Wallet Factory"}),"\n",(0,a.jsxs)(t.p,{children:["Sequence Wallets are created using the ",(0,a.jsx)(t.a,{href:"https://github.com/0xsequence/wallet-contracts/blob/e0c5382636a88b4db4bcf0a70623355d7cd30fb4/contracts/Factory.sol",children:"Factory"})," contract, when called it creates child ",(0,a.jsx)(t.a,{href:"https://github.com/0xsequence/wallet-contracts/blob/e0c5382636a88b4db4bcf0a70623355d7cd30fb4/contracts/Wallet.sol",children:"MinimalUpgradeableProxies"}),' contracts, which are in essence the "boot" code of all Sequence wallets.']}),"\n",(0,a.jsx)(t.h2,{id:"factory-api",children:"Factory API"}),"\n",(0,a.jsx)(t.h3,{id:"deploy",children:"deploy"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-solidity",children:"  function deploy(\n    address _mainModule,\n    bytes32 _salt\n  ) public payable returns (address _contract)\n"})}),"\n",(0,a.jsxs)(t.p,{children:["Creates a child MinimalUpgradeableProxy using ",(0,a.jsx)(t.a,{href:"https://eips.ethereum.org/EIPS/eip-1014",children:"CREATE2"}),", the proxy initially points to the provided ",(0,a.jsx)(t.code,{children:"_mainModule"}),".\nNo initialize code is executed."]}),"\n",(0,a.jsx)(t.h4,{id:"parameters",children:"Parameters:"}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Name"}),(0,a.jsx)(t.th,{children:"Type"}),(0,a.jsx)(t.th,{children:"Description"})]})}),(0,a.jsxs)(t.tbody,{children:[(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"_mainModule"}),(0,a.jsx)(t.td,{children:"address"}),(0,a.jsx)(t.td,{children:"Initial implementation for the new proxy contract, expected to point to a valid Sequence wallet implementation with support for counter-factual initialization."})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"_salt"}),(0,a.jsx)(t.td,{children:"bytes32"}),(0,a.jsxs)(t.td,{children:["Arbitrary value to be used as ",(0,a.jsx)(t.code,{children:"create2"})," salt. Sequence's ",(0,a.jsx)(t.code,{children:"mainModule"})," uses the salt to obtain a hash with the initial configuration for the wallet (See ",(0,a.jsx)(t.a,{href:"#",children:"ImageHash"}),")."]})]})]})]}),"\n",(0,a.jsx)(t.h4,{id:"return-values",children:"Return Values:"}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Name"}),(0,a.jsx)(t.th,{children:"Type"}),(0,a.jsx)(t.th,{children:"Description"})]})}),(0,a.jsx)(t.tbody,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"_contract"}),(0,a.jsx)(t.td,{children:"address"}),(0,a.jsx)(t.td,{children:"Address of the created proxy contract."})]})})]}),"\n",(0,a.jsxs)(t.admonition,{title:"Unsanitized input",type:"caution",children:[(0,a.jsxs)(t.p,{children:["The Factory contract ",(0,a.jsx)(t.strong,{children:"does not"})," check if the provided ",(0,a.jsx)(t.code,{children:"_mainModule"})," is a valid Sequence wallet implementation, or if ",(0,a.jsx)(t.code,{children:"_salt"})," is a valid Sequence configuration."]}),(0,a.jsxs)(t.p,{children:["Using invalid parameters will result on a proxy contract that ",(0,a.jsx)(t.strong,{children:"may not"})," be usable, and could result in loss of funds."]})]}),"\n",(0,a.jsx)(t.h2,{id:"counter-factual-addresses",children:"Counter factual addresses"}),"\n",(0,a.jsxs)(t.p,{children:["Sequence wallets are counter-factual by design, this means that the wallet's address can be known before the wallet is deployed; any two combinations of the ",(0,a.jsx)(t.code,{children:"mainModule"})," and ",(0,a.jsx)(t.code,{children:"salt"})," values will result in the same wallet address."]}),"\n",(0,a.jsxs)(t.p,{children:["This property alongside the use of ",(0,a.jsx)(t.a,{href:"/wallet/wallet-contracts/universal-deployer",children:"SingletonDeployer"})," or ",(0,a.jsx)(t.a,{href:"/wallet/wallet-contracts/universal-deployer",children:"UniversalDeployer"})," is the reason why Sequence wallets can obtain the same address on multiple chains."]}),"\n",(0,a.jsxs)(t.admonition,{title:"Gas-free wallet creation",type:"tip",children:[(0,a.jsxs)(t.p,{children:["Sequence wallets are ",(0,a.jsx)(t.strong,{children:"100% counterfactual"}),", meaning that funds can be safely transferred to the wallet's address without the need for calling the ",(0,a.jsx)(t.code,{children:"deploy"})," function."]}),(0,a.jsxs)(t.p,{children:["Deploying the wallet is only required before the first transaction is sent ",(0,a.jsx)(t.strong,{children:"from"})," the wallet."]})]})]})}function h(e={}){const{wrapper:t}={...(0,n.a)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},4089:(e,t,l)=>{l.d(t,{Z:()=>c,a:()=>r});var a=l(959);const n={},s=a.createContext(n);function r(e){const t=a.useContext(s);return a.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:r(e.components),a.createElement(s.Provider,{value:t},e.children)}}}]);
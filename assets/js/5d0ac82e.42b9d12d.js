"use strict";(self.webpackChunk_0xsequence_docs=self.webpackChunk_0xsequence_docs||[]).push([[9537],{456:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>t,metadata:()=>d,toc:()=>r});var a=n(1527),s=n(7279);const t={},o="Validation",d={id:"waas/waas-auth/validation",title:"Validation",description:"Users with Auth + WaaS go through two distinct flows based on the login method:",source:"@site/docs/400-waas/02-waas-auth/05-validation.mdx",sourceDirName:"400-waas/02-waas-auth",slug:"/waas/waas-auth/validation",permalink:"/waas/waas-auth/validation",draft:!1,unlisted:!1,editUrl:"https://github.com/0xsequence/docs/edit/master/docs/400-waas/02-waas-auth/05-validation.mdx",tags:[],version:"current",sidebarPosition:5,frontMatter:{},sidebar:"sidebar",previous:{title:"Wallets and transactions",permalink:"/waas/waas-auth/use-wallets"},next:{title:"Transaction receipts",permalink:"/waas/waas-auth/transaction-receipts"}},l={},r=[{value:"Email login (one-time code)",id:"email-login-one-time-code",level:3},{value:"Social login",id:"social-login",level:3},{value:"Validation status",id:"validation-status",level:2},{value:"Trigger session validation",id:"trigger-session-validation",level:3},{value:"onValidationRequired callback",id:"onvalidationrequired-callback",level:4},{value:"Listen for session validations",id:"listen-for-session-validations",level:3},{value:"Automatic session validation",id:"automatic-session-validation",level:2}];function c(e){const i={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",p:"p",pre:"pre",...(0,s.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.h1,{id:"validation",children:"Validation"}),"\n",(0,a.jsx)(i.p,{children:"Users with Auth + WaaS go through two distinct flows based on the login method:"}),"\n",(0,a.jsx)(i.h3,{id:"email-login-one-time-code",children:"Email login (one-time code)"}),"\n",(0,a.jsx)(i.p,{children:"For users logging in with an email, Amazon Cognito sends a one-time code to validate their identity. This is a trusted method that does not require additional verification."}),"\n",(0,a.jsx)(i.h3,{id:"social-login",children:"Social login"}),"\n",(0,a.jsx)(i.p,{children:"Users who log in via established social auth providers like Google or Facebook don't need additional validation. However, when logging in using a custom provider, we cannot guarantee sufficient protection of user's identity. Due to this, we might require additional verification by asking the user to provide a one-time code we send to their email address."}),"\n",(0,a.jsx)(i.p,{children:"Please contact Sequence support if you wish to discuss whether your authentication provider can be considered trusted."}),"\n",(0,a.jsx)(i.h2,{id:"validation-status",children:"Validation status"}),"\n",(0,a.jsxs)(i.p,{children:["To check the validation status of the current session, use the ",(0,a.jsx)(i.code,{children:"isSessionValid"})," method. This returns ",(0,a.jsx)(i.code,{children:"true"})," for email login and trusted social logins and ",(0,a.jsx)(i.code,{children:"false"})," for custom logins until email validation is complete."]}),"\n",(0,a.jsx)(i.pre,{children:(0,a.jsx)(i.code,{className:"language-ts",children:"const isValid = await waas.isSessionValid()\nconsole.log(isValid)\n"})}),"\n",(0,a.jsx)(i.pre,{children:(0,a.jsx)(i.code,{className:"language-stdout",children:"true\n"})}),"\n",(0,a.jsx)(i.h3,{id:"trigger-session-validation",children:"Trigger session validation"}),"\n",(0,a.jsxs)(i.p,{children:["Manually trigger a session validation with the ",(0,a.jsx)(i.code,{children:"validateSession"})," method. This will send a code to the user's email. If validated within 10 minutes, the method returns ",(0,a.jsx)(i.code,{children:"true"}),"; otherwise, it returns ",(0,a.jsx)(i.code,{children:"false"}),"."]}),"\n",(0,a.jsx)(i.pre,{children:(0,a.jsx)(i.code,{className:"language-ts",children:"const result = await waas.validateSession()\n"})}),"\n",(0,a.jsx)(i.pre,{children:(0,a.jsx)(i.code,{className:"language-stdout",children:"true\n"})}),"\n",(0,a.jsxs)(i.p,{children:["Once user receives the code, he can validate the session with the ",(0,a.jsx)(i.code,{children:"finishValidateSession"})," method that takes the code as an argument. If the code is valid, the method returns ",(0,a.jsx)(i.code,{children:"true"}),"; otherwise, it returns ",(0,a.jsx)(i.code,{children:"false"}),"."]}),"\n",(0,a.jsx)(i.pre,{children:(0,a.jsx)(i.code,{className:"language-ts",children:"const result = await waas.finishValidateSession('123456')\n"})}),"\n",(0,a.jsx)(i.pre,{children:(0,a.jsx)(i.code,{className:"language-stdout",children:"true\n"})}),"\n",(0,a.jsx)(i.h4,{id:"onvalidationrequired-callback",children:"onValidationRequired callback"}),"\n",(0,a.jsxs)(i.p,{children:["The ",(0,a.jsx)(i.code,{children:"onValidationRequired"})," callback is triggered when a session validation is required. This can happen when a user tries to perform an action that requires validation, such as sending a transaction or signing a message. It determines whether the session validation should be triggered or not. If the callback returns ",(0,a.jsx)(i.code,{children:"true"}),", the session validation is triggered. If it returns ",(0,a.jsx)(i.code,{children:"false"}),", the action is cancelled."]}),"\n",(0,a.jsx)(i.pre,{children:(0,a.jsx)(i.code,{className:"language-ts",children:"const tx = await waas.sendERC20({\n  validation: {\n    onValidationRequired: () => true\n  },\n  chainId: 42161,\n  token: '0x6b175474e89094c44da98b954eedeac495271d0f', // DAI\n  to: '0x27CabC9700EE6Db2797b6AC1e1eCe81C72A2cD8D',    // Recipient\n  value: '200000000000000000000',                      // 200 DAI\n})\n"})}),"\n",(0,a.jsx)(i.h3,{id:"listen-for-session-validations",children:"Listen for session validations"}),"\n",(0,a.jsxs)(i.p,{children:["Events like transaction sends may silently prompt session validation. Use the ",(0,a.jsx)(i.code,{children:"onValidationRequired"})," hook to catch such instances."]}),"\n",(0,a.jsx)(i.pre,{children:(0,a.jsx)(i.code,{className:"language-ts",children:"waas.onValidationRequired(() => {\n  console.log('Session has been triggered for validation');\n})\n\nawait waas.sendTransaction({ chainId: 1 }, { to: '0x...', value: '1' });\n"})}),"\n",(0,a.jsx)(i.pre,{children:(0,a.jsx)(i.code,{className:"language-stdout",children:"Session has been triggered for validation\n"})}),"\n",(0,a.jsx)(i.h2,{id:"automatic-session-validation",children:"Automatic session validation"}),"\n",(0,a.jsxs)(i.p,{children:["Session validation is automatic when certain actions requiring validation are performed. This can be managed using the ",(0,a.jsx)(i.code,{children:"onValidationRequired"})," hook."]}),"\n",(0,a.jsx)(i.pre,{children:(0,a.jsx)(i.code,{className:"language-ts",children:"const tx = await waas.sendTransaction({\n  chainId: 1,\n  validation: {\n    onValidationRequired: () => {\n      console.log('Session has been triggered for validation');\n      return true;\n    }\n  },\n  to: '0x061150e5574716DBb1a2cdf54b3DcE9F94395f65',\n  value: '1'\n})\n"})}),"\n",(0,a.jsxs)(i.p,{children:["By returning ",(0,a.jsx)(i.code,{children:"true"})," or ",(0,a.jsx)(i.code,{children:"false"})," from the ",(0,a.jsx)(i.code,{children:"onValidationRequired"})," hook, you either continue or cancel the action, respectively."]})]})}function h(e={}){const{wrapper:i}={...(0,s.a)(),...e.components};return i?(0,a.jsx)(i,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},7279:(e,i,n)=>{n.d(i,{Z:()=>d,a:()=>o});var a=n(959);const s={},t=a.createContext(s);function o(e){const i=a.useContext(t);return a.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function d(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),a.createElement(t.Provider,{value:i},e.children)}}}]);